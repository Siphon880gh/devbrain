
## Forward

Welcome to this comprehensive tutorial on WordPress plugin development! This guide will walk you through every line of code in our simple WF **Copyright Year Shortcode** plugin, explaining WordPress concepts and best practices along the way.

By the end of this tutorial, you'd have learned how to develop a very basic plugin that injects evaluated text at a shortcode

**Example:**

```
Copyright ¬© [WF_YEAR] Your Company Name
```

Will display as (if the current year is 2025):

```
Copyright ¬© 2025 Your Company Name
```


The full code you would have developed is:
https://github.com/Siphon880gh/wordpress-current-year-shortcode

## Contents
1. [Plugin Structure Overview](#plugin-structure-overview)
2. [Plugin Header: The Foundation](#plugin-header-the-foundation)
3. [Security First: Preventing Direct Access](#security-first-preventing-direct-access)
4. [Object-Oriented Approach](#object-oriented-approach)
5. [WordPress Hooks System](#wordpress-hooks-system)
6. [Shortcode Registration](#shortcode-registration)
7. [The Shortcode Handler Function](#the-shortcode-handler-function)
8. [WordPress Filters](#wordpress-filters)
9. [Plugin Activation & Deactivation](#plugin-activation--deactivation)
10. [Best Practices Implemented](#best-practices-implemented)

---

## Plugin Structure Overview

Our plugin consists of one main PHP file (`wf-year-shortcode.php`) that contains everything needed to create a functional WordPress plugin. Here's what it does:

- Registers a shortcode `[WF_YEAR]`
- Returns the current year when the shortcode is used
- Follows WordPress coding standards and best practices

---

## Plugin Header: The Foundation

```php
<?php
/**
 * Plugin Name: WF Year Shortcode
 * Plugin URI: https://example.com/wf-year-shortcode
 * Description: A simple plugin that provides a shortcode [WF_YEAR] to display the current year.
 * Version: 1.0.0
 * Author: Your Name
 * Author URI: https://example.com
 * License: GPL v2 or later
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain: wf-year-shortcode
 * Domain Path: /languages
 */
```

### What's happening here?

**The Plugin Header** is a special comment block that WordPress reads to understand your plugin. Each line has a specific purpose:

- **Plugin Name**: What appears in the WordPress admin plugins list
- **Plugin URI**: Link to your plugin's homepage (optional but professional)
- **Description**: Brief explanation shown in the plugins list
- **Version**: Current version number (important for updates)
- **Author**: Your name or company
- **Author URI**: Link to your website
- **License**: Legal license (GPL is WordPress standard)
- **Text Domain**: Used for translations (internationalization)
- **Domain Path**: Where translation files are stored

> üí° **Beginner Tip**: WordPress scans the first 8 kilobytes of your PHP file looking for this header. That's why it must be at the very top!

---

## Security First: Preventing Direct Access

```php
// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}
```

### Why is this important?

**ABSPATH** is a WordPress constant that's only defined when WordPress is running. This code prevents people from accessing your plugin file directly through a web browser (like `yoursite.com/wp-content/plugins/yourplugin/file.php`).

**What happens without this check?**
- Someone could potentially see your code
- PHP errors might be exposed
- Security vulnerabilities could be exploited

> üîí **Security Note**: This is considered a WordPress security best practice and should be in every plugin file.

---

## Object-Oriented Approach

```php
class WF_Year_Shortcode {
    public function __construct() {
        add_action('init', array($this, 'init'));
    }
    
    public function init() {
        add_shortcode('WF_YEAR', array($this, 'wf_year_shortcode_handler'));
    }
    // ... more methods
}
```

### Why use a class?

**Benefits of Object-Oriented Programming in WordPress:**
1. **Organization**: Keeps related code together
2. **Namespace**: Prevents function name conflicts with other plugins
3. **Reusability**: Easy to extend or modify
4. **Professional**: Industry standard approach

**The Constructor (`__construct`)**:
- Automatically runs when the class is instantiated
- We hook into WordPress's `init` action here
- `array($this, 'init')` is how we reference class methods in hooks

> üìö **Learning Point**: `array($this, 'method_name')` is the old PHP way to reference class methods. Modern PHP uses `[$this, 'method_name']`, but WordPress maintains backward compatibility.

---

## WordPress Hooks System

```php
add_action('init', array($this, 'init'));
```

### Understanding WordPress Hooks

**Actions** are specific points in WordPress execution where you can "hook in" your code. Think of them as events:

- `init`: WordPress has finished loading
- `wp_head`: WordPress is outputting the `<head>` section
- `wp_footer`: WordPress is outputting the footer

**Common Actions for Plugin Development:**
- `plugins_loaded`: All plugins have been loaded
- `init`: WordPress initialization is complete
- `admin_init`: Admin area initialization
- `wp_enqueue_scripts`: Time to add CSS/JS files

> üéØ **Best Practice**: Use `init` for registering shortcodes, post types, and taxonomies.

---

## Shortcode Registration

```php
add_shortcode('WF_YEAR', array($this, 'wf_year_shortcode_handler'));
```

^ Note the desired shortcode AND the shortcode handler function are passed into WP core method `add_shortcode` for registration. Once registered, writing the shortcode like `[WF_YEAR]` into your webpage or header or footer, it will call the shortcode handler function which usually will write some dynamic or static text in place of the shortcode. You write the shortcode at the Code tab while editing a page. We will define the shortcode handler soon.

### How Shortcodes Work

**Shortcodes** are WordPress's way of letting users execute code through simple text snippets in content.

**The Registration Process:**
1. `add_shortcode()` tells WordPress about your shortcode
2. First parameter: the shortcode name (what users type: `[WF_YEAR]`)
3. Second parameter: the function that handles the shortcode

**When WordPress processes content:**
1. It scans for text matching `[shortcode_name]`
2. Calls your handler function
3. Replaces the shortcode with your function's return value

> ‚ö†Ô∏è **Important**: Shortcode names should be unique across all plugins to avoid conflicts.

---

## The Shortcode Handler Function

```php
public function wf_year_shortcode_handler($atts = array(), $content = null) {
    // Get current year
    $current_year = date('Y');
    
    // Apply filter to allow customization
    $current_year = apply_filters('wf_year_shortcode_year', $current_year);
    
    return esc_html($current_year);
}
```

^ By returning text in the shortcode handler, it will write that text in place of the shortcode.

### Breaking Down the Handler

**Function Parameters:**
- `$atts`: Shortcode attributes (like `[WF_YEAR format="long"]`)
- `$content`: Content between opening and closing shortcode tags

**The Logic:**
1. `date('Y')`: PHP function that returns current year as 4-digit string
2. `apply_filters()`: Allows other developers to modify the output
3. `esc_html()`: WordPress security function that prevents XSS attacks

**Security with `esc_html()`:**
```php
// Without escaping (dangerous):
return $current_year; // Could output malicious code

// With escaping (safe):
return esc_html($current_year); // Only safe HTML characters
```

> üõ°Ô∏è **Security Rule**: Always escape output that goes to the browser.

---

## WordPress Filters

```php
$current_year = apply_filters('wf_year_shortcode_year', $current_year);
```

### Understanding Filters

**Filters** allow other developers (or theme authors) to modify your plugin's output without editing your code.

**Example Usage by Another Developer:**
```php
// In theme's functions.php or another plugin
add_filter('wf_year_shortcode_year', function($year) {
    return $year . ' CE'; // Adds "CE" after the year
});
```

**Filter Benefits:**
- **Extensibility**: Others can customize without breaking updates
- **Flexibility**: Multiple modifications can be chained
- **Community**: Follows WordPress ecosystem standards

> üîß **Developer Tip**: Always provide filters for any output that might need customization.

---

## Plugin Activation & Deactivation

Here we define activation and deactivation hooks to run setup and cleanup when the site admin toggles the plugin on or off. This is standard lifecycle management‚Äîand a best practice for every WordPress plugin.

```php
register_activation_hook(__FILE__, 'wf_year_shortcode_activate');
register_deactivation_hook(__FILE__, 'wf_year_shortcode_deactivate');

function wf_year_shortcode_activate() {
    flush_rewrite_rules();
}

function wf_year_shortcode_deactivate() {
    flush_rewrite_rules();
}
```

### Lifecycle Management

**Activation Hook:**
- Runs once when the plugin is activated
- Perfect for creating database tables, setting default options
- `flush_rewrite_rules()` refreshes WordPress URL structure

**Deactivation Hook:**
- Runs when plugin is deactivated (but not deleted)
- Clean up temporary data, flush caches
- Don't delete user data here (use uninstall.php for that)

**What `flush_rewrite_rules()` Does:**
- Refreshes WordPress's internal URL routing
- Necessary when adding custom post types or rewrite rules
- Ensures WordPress recognizes any URL changes

> üìù **Note**: For our simple shortcode plugin, flushing rewrite rules isn't strictly necessary, but it's shown as a best practice example.

---

## Result plugin file:

This plugin only needs one file because it's simple to implement that it doesn't need multiple files. It adds a shortcode that prints the current year using a core PHP function.

wf-year-shortcode.php:
```
<?php
/**
 * Plugin Name: WF Year Shortcode
 * Plugin URI: https://www.linkedin.com/in/weng-fung/
 * Description: A simple plugin that provides a shortcode [WF_YEAR] to display the current year.
 * Version: 1.0.0
 * Author: Weng Fei Fung
 * Author URI: https://www.linkedin.com/in/weng-fung/
 * License: GPL v2 or later
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain: wf-year-shortcode
 * Domain Path: /languages
 */

// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}

/**
 * Main plugin class
 */
class WF_Year_Shortcode {

    /**
     * Constructor
     */
    public function __construct() {
        add_action('init', array($this, 'init'));
    }

    /**
     * Initialize the plugin
     */
    public function init() {
        // Register the shortcode
        add_shortcode('WF_YEAR', array($this, 'wf_year_shortcode_handler'));
    }

    /**
     * Shortcode handler for [WF_YEAR]
     * 
     * @param array $atts Shortcode attributes
     * @param string $content Shortcode content
     * @return string Current year
     */
    public function wf_year_shortcode_handler($atts = array(), $content = null) {
        // Get current year
        $current_year = date('Y');
        
        // Apply filter to allow customization
        $current_year = apply_filters('wf_year_shortcode_year', $current_year);
        
        return esc_html($current_year);
    }

    /**
     * Get current year (helper method)
     * 
     * @return string Current year
     */
    public static function get_current_year() {
        return date('Y');
    }
}

/**
 * Initialize the plugin
 */
function wf_year_shortcode_init() {
    new WF_Year_Shortcode();
}

// Hook into WordPress
add_action('plugins_loaded', 'wf_year_shortcode_init');

/**
 * Activation hook
 */
register_activation_hook(__FILE__, 'wf_year_shortcode_activate');

function wf_year_shortcode_activate() {
    // Flush rewrite rules on activation
    flush_rewrite_rules();
}

/**
 * Deactivation hook
 */
register_deactivation_hook(__FILE__, 'wf_year_shortcode_deactivate');

function wf_year_shortcode_deactivate() {
    // Clean up on deactivation
    flush_rewrite_rules();
}
```



---

## **Test Plugin**:

Just drop the files into the plugins folder like here:
```
wp-content/plugins/wp_copyright_year/
```

So the code file could be at:
```
wp-content/plugins/wp_copyright_year/wf-year-shortcode.php
```

Refresh the plugin page and activate your plugin. 
![[Pasted image 20250817193230.png]]

Then edit your blog/webpage/header/footer. Click into "Code" mode for your post/webpage/header/footer and then copy your shortcode there.

![[Pasted image 20250817193034.png]]


---

## **Conclusion**

This simple shortcode plugin demonstrates fundamental WordPress development concepts:
- Plugin structure and headers
- Security considerations
- Object-oriented programming
- WordPress hooks and filters
- Shortcode API

Understanding these concepts provides a solid foundation for more complex WordPress development projects. Every professional WordPress plugin follows these same patterns and principles.