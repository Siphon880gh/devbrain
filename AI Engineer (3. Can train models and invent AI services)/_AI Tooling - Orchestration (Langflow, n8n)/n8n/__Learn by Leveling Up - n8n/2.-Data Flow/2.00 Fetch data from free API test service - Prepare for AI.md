
Goal:
I have an imaginary product and fake survey data on who expressed interest in new features. And had AI generate emails based on their interest level

This tutorial will only cover up the steps to right before AI nodes. Next lesson will cover AI nodes

You'll learn:
fetching json from an url
slicing array of objects down to a subset

https://jsonplaceholder.typicode.com/users return an array of 10 json users. Let's have n8n retrieve them.

> [!note] Did JSON Placeholder retire?
> Note if their url or service retired, you can setup your own webhosted online endpoint to this data set:
> ```
> [  
>   {  
>     "id": 1,  
>     "name": "Leanne Graham",  
>     "username": "Bret",  
>     "email": "Sincere@april.biz",  
>     "address": {  
>       "street": "Kulas Light",  
>       "suite": "Apt. 556",  
>       "city": "Gwenborough",  
>       "zipcode": "92998-3874",  
>       "geo": {  
>         "lat": "-37.3159",  
>         "lng": "81.1496"  
>       }  
>     },  
>     "phone": "1-770-736-8031 x56442",  
>     "website": "hildegard.org",  
>     "company": {  
>       "name": "Romaguera-Crona",  
>       "catchPhrase": "Multi-layered client-server neural-net",  
>       "bs": "harness real-time e-markets"  
>     }  
>   },  
>   {  
>     "id": 2,  
>     "name": "Ervin Howell",  
>     "username": "Antonette",  
>     "email": "Shanna@melissa.tv",  
>     "address": {  
>       "street": "Victor Plains",  
>       "suite": "Suite 879",  
>       "city": "Wisokyburgh",  
>       "zipcode": "90566-7771",  
>       "geo": {  
>         "lat": "-43.9509",  
>         "lng": "-34.4618"  
>       }  
>     },  
>     "phone": "010-692-6593 x09125",  
>     "website": "anastasia.net",  
>     "company": {  
>       "name": "Deckow-Crist",  
>       "catchPhrase": "Proactive didactic contingency",  
>       "bs": "synergize scalable supply-chains"  
>     }  
>   },  
>   {  
>     "id": 3,  
>     "name": "Clementine Bauch",  
>     "username": "Samantha",  
>     "email": "Nathan@yesenia.net",  
>     "address": {  
>       "street": "Douglas Extension",  
>       "suite": "Suite 847",  
>       "city": "McKenziehaven",  
>       "zipcode": "59590-4157",  
>       "geo": {  
>         "lat": "-68.6102",  
>         "lng": "-47.0653"  
>       }  
>     },  
>     "phone": "1-463-123-4447",  
>     "website": "ramiro.info",  
>     "company": {  
>       "name": "Romaguera-Jacobson",  
>       "catchPhrase": "Face to face bifurcated interface",  
>       "bs": "e-enable strategic applications"  
>     }  
>   },  
>   {  
>     "id": 4,  
>     "name": "Patricia Lebsack",  
>     "username": "Karianne",  
>     "email": "Julianne.OConner@kory.org",  
>     "address": {  
>       "street": "Hoeger Mall",  
>       "suite": "Apt. 692",  
>       "city": "South Elvis",  
>       "zipcode": "53919-4257",  
>       "geo": {  
>         "lat": "29.4572",  
>         "lng": "-164.2990"  
>       }  
>     },  
>     "phone": "493-170-9623 x156",  
>     "website": "kale.biz",  
>     "company": {  
>       "name": "Robel-Corkery",  
>       "catchPhrase": "Multi-tiered zero tolerance productivity",  
>       "bs": "transition cutting-edge web services"  
>     }  
>   },  
>   {  
>     "id": 5,  
>     "name": "Chelsey Dietrich",  
>     "username": "Kamren",  
>     "email": "Lucio_Hettinger@annie.ca",  
>     "address": {  
>       "street": "Skiles Walks",  
>       "suite": "Suite 351",  
>       "city": "Roscoeview",  
>       "zipcode": "33263",  
>       "geo": {  
>         "lat": "-31.8129",  
>         "lng": "62.5342"  
>       }  
>     },  
>     "phone": "(254)954-1289",  
>     "website": "demarco.info",  
>     "company": {  
>       "name": "Keebler LLC",  
>       "catchPhrase": "User-centric fault-tolerant solution",  
>       "bs": "revolutionize end-to-end systems"  
>     }  
>   },  
>   {  
>     "id": 6,  
>     "name": "Mrs. Dennis Schulist",  
>     "username": "Leopoldo_Corkery",  
>     "email": "Karley_Dach@jasper.info",  
>     "address": {  
>       "street": "Norberto Crossing",  
>       "suite": "Apt. 950",  
>       "city": "South Christy",  
>       "zipcode": "23505-1337",  
>       "geo": {  
>         "lat": "-71.4197",  
>         "lng": "71.7478"  
>       }  
>     },  
>     "phone": "1-477-935-8478 x6430",  
>     "website": "ola.org",  
>     "company": {  
>       "name": "Considine-Lockman",  
>       "catchPhrase": "Synchronised bottom-line interface",  
>       "bs": "e-enable innovative applications"  
>     }  
>   },  
>   {  
>     "id": 7,  
>     "name": "Kurtis Weissnat",  
>     "username": "Elwyn.Skiles",  
>     "email": "Telly.Hoeger@billy.biz",  
>     "address": {  
>       "street": "Rex Trail",  
>       "suite": "Suite 280",  
>       "city": "Howemouth",  
>       "zipcode": "58804-1099",  
>       "geo": {  
>         "lat": "24.8918",  
>         "lng": "21.8984"  
>       }  
>     },  
>     "phone": "210.067.6132",  
>     "website": "elvis.io",  
>     "company": {  
>       "name": "Johns Group",  
>       "catchPhrase": "Configurable multimedia task-force",  
>       "bs": "generate enterprise e-tailers"  
>     }  
>   },  
>   {  
>     "id": 8,  
>     "name": "Nicholas Runolfsdottir V",  
>     "username": "Maxime_Nienow",  
>     "email": "Sherwood@rosamond.me",  
>     "address": {  
>       "street": "Ellsworth Summit",  
>       "suite": "Suite 729",  
>       "city": "Aliyaview",  
>       "zipcode": "45169",  
>       "geo": {  
>         "lat": "-14.3990",  
>         "lng": "-120.7677"  
>       }  
>     },  
>     "phone": "586.493.6943 x140",  
>     "website": "jacynthe.com",  
>     "company": {  
>       "name": "Abernathy Group",  
>       "catchPhrase": "Implemented secondary concept",  
>       "bs": "e-enable extensible e-tailers"  
>     }  
>   },  
>   {  
>     "id": 9,  
>     "name": "Glenna Reichert",  
>     "username": "Delphine",  
>     "email": "Chaim_McDermott@dana.io",  
>     "address": {  
>       "street": "Dayna Park",  
>       "suite": "Suite 449",  
>       "city": "Bartholomebury",  
>       "zipcode": "76495-3109",  
>       "geo": {  
>         "lat": "24.6463",  
>         "lng": "-168.8889"  
>       }  
>     },  
>     "phone": "(775)976-6794 x41206",  
>     "website": "conrad.com",  
>     "company": {  
>       "name": "Yost and Sons",  
>       "catchPhrase": "Switchable contextually-based project",  
>       "bs": "aggregate real-time technologies"  
>     }  
>   },  
>   {  
>     "id": 10,  
>     "name": "Clementina DuBuque",  
>     "username": "Moriah.Stanton",  
>     "email": "Rey.Padberg@karina.biz",  
>     "address": {  
>       "street": "Kattie Turnpike",  
>       "suite": "Suite 198",  
>       "city": "Lebsackbury",  
>       "zipcode": "31428-2261",  
>       "geo": {  
>         "lat": "-38.2386",  
>         "lng": "57.2232"  
>       }  
>     },  
>     "phone": "024-648-3804",  
>     "website": "ambrose.net",  
>     "company": {  
>       "name": "Hoeger LLC",  
>       "catchPhrase": "Centralized empowering task-force",  
>       "bs": "target end-to-end models"  
>     }  
>   }  
> ]
> ```
> 

Add "HTTP Request" node

As with all node creations, you get kicked into that node's settings right away when you create the node.

Set to GET to that url
![[Pasted image 20250610025202.png]]



Caveat - Schema tab looks like only returned one object instead of 10. That's the schema! Switch to table or json to view the actual data.
![[Pasted image 20250610025211.png]]

You'll land on the canva after closing http request settings:
![[Pasted image 20250610025234.png]]


Add Code node:
- Presents you with:
- ![[Pasted image 20250610025247.png]]

So there's already some completed code for you to quickly rewrite. Lets change it to randomize the interest level of these users. It'd represent an user responding to a survey item "are you interested in staying in the loop on the next product feature?":
```
// Loop over input items and mock a fake interest level  
for (const item of $input.all()) {  
  item.json.interestLevel = (Math.ceil(Math.random()*3)-1); // 0-3 interest level  
}  
  
return $input.all();
```


Interest levels are:
- 0 not interested
- 1 a little interested
- 2 moderate interest
- 3 super interested


![[Pasted image 20250610025332.png]]

The code should be rewritten to getting only the first 3 objects:
```
// Loop over input items and mock a fake interest level  
for (const item of $input.all()) {  
  item.json.interestLevel = (Math.ceil(Math.random()*3)-1); // 0-3 interest level  
}  
  
const inputs = $input.all().slice(0,3);  
  
return inputs;
```

Notice it went from 1 item (which is schedule's json output of the result of the cron trigger), to http request getting 10 items of users, to after the code, it's sliced down to 3 items. See the gray text above each arrow:
![[Pasted image 20250610025354.png]]

> [!note] Sidenote - Step by step running
> Ran up to http request after pressing play on http request
> 
> ![[Pasted image 20250610025408.png]]
> 
> Afterwards, ran up to code after pressing play on code
> ![[Pasted image 20250610025420.png]]
>

We are done with this tutorial. The next tutorial continues from this point because it will talk about adding an AI agent. We have enough data to generate emails that are based off user's interest level.
