The previous challenge at [[2 Chrome extension foundational with popup]] includes popup but it also included a bunch of foundational information that's important for developing any chrome extension presentation (popup, content, devtools panel, devtools sidebar, etc). This tutorial will go over popup again but without the general foundationals. 

We will go more in-depth into the popup to layer more tools and know-how when it comes to implementing Chrome extension popup (again, can be thought of as a popover when you click a chrome extension pinned icon on the web browser).

---

## Multipage

Let's add ability to have multiple pages in the popup:

Create a popup2.html

popup2.html:
```
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popup</title>
    <link rel="stylesheet" href="popup.css">
</head>

<body>
    <h1>YOUR_APP</h1>

    <main>
        <div>
            By Weng:
        </div>

        <aside>
            <a target="_blank" href="https://www.github.com/Siphon880gh/" rel="nofollow">
                <img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white"
                    data-canonical-src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white"
                    style="max-width: 100%; height:20px;">
            </a>
            <a target="_blank" href="https://www.linkedin.com/in/weng-fung/" rel="nofollow">
                <img src="https://img.shields.io/badge/LinkedIn-blue?style=flat&logo=linkedin&labelColor=blue"
                    alt="Linked-In"
                    data-canonical-src="https://img.shields.io/badge/LinkedIn-blue?style=flat&amp;logo=linkedin&amp;labelColor=blue"
                    style="max-width:100%;">
            </a>
            <a target="_blank" href="https://www.youtube.com/@WayneTeachesCode/" rel="nofollow">
                <img src="https://img.shields.io/badge/Youtube-red?style=flat&logo=youtube&labelColor=red" alt="Youtube"
                    data-canonical-src="https://img.shields.io/badge/Youtube-red?style=flat&amp;logo=youtube&amp;labelColor=red"
                    style="max-width:100%;">
            </a>
        </aside>

        <div class="spacer-vertical"></div>
        <h2>Title:</h2>
        <p>LOREM IPSUM DOLOR SIT AMET CONSECTETUR ADIPISICING ELIT. REPELLENDUS HIC SIT LIBERO? EXCEPTURI, OPTIO AUT
            REICIENDIS DOLOREMQUE TEMPORE, ISTE HARUM ASPERNATUR ET, OFFICIIS EARUM ALIQUAM. QUIBUSDAM CUM NOSTRUM QUOS
            COMMODI?</p>

        <div class="spacer-vertical"></div>
        <button id="change-style">Alert me</button>

        <div class="spacer-vertical"></div>
        <a href="popup.html">Popup.html</a>

    </main>
    <script src="popup.js"></script>
</body>

</html>
```


^Notice that the new popup2.html links back to the original popup.html

Add link to new page at the original popup.html: (add before `</main>` closing tag)
```
	<div role="spacer-vertical" style="margin-top:11px"></div>
	<a href="popup2.html">Popup2.html</a>
</main>
```

Let's think about how it should look. The popup should show "Lorem ipsum" text. Clicking the link to popup2.html at the bottom of the popup will show all caps "LOREM IPSUM" text.


![[Chrome-Extension-Popup-Multipage.gif]]

---

## External links

At popup.html, let's change the link to (right before the `</main>` closing tag):
```
	<div role="spacer-vertical" style="margin-top:11px"></div>
	<a href="https://www.google.com">Google</a>
</main>
```


Update Chrome extension, open popup, and click the Google link.
Nothing happens! 

If you inspected the popup, there's no error in console. However, in Network, you'll see that it's cancelled and 0 size downloaded. There's no other hints (Even Response tab of that network request is just blank):
![[Pasted image 20250320211611.png]]


#### External Links with Target blank

Adjust popup.html's link by adding `target="_blank"`
```

        <div class="spacer-vertical"></div>
        <a href="https://www.google.com" target="_blank">Google</a>

    </main>

```

Update the chrome extension, open, and test clicking the Google link.

Notice it opens this time. But it opens in new tab.

There are no permission settings in manifest.json. The way to open external links is through opening in a tab, NOT within the popup.


----

### External Links with Chrome Tabs API

This may seem trivial, but you can control if the link opens in the current active tab or always open a new tab:

![[Chrome-Extension-Tab-Control.gif]]

Adjust popup.html's link code back to normal targeting (remove `target="_blank"`):
```
        <div class="spacer-vertical"></div>
        <a href="https://www.google.com">Google</a>

    </main>

```

Add this to popup.js:
```
// Global setting: true = open in new tab, false = reuse active tab
const openInNewTab = true;

document.body.onclick = function(e) {
  e = e || event;
  const target = e.target || e.srcElement;

  if (target.nodeName !== 'A') return;

  const href = target.href;

  if (openInNewTab) {
    chrome.tabs.create({ url: href });
  } else {
    chrome.tabs.query({ active: true, currentWindow: true }, function(tabs) {
      chrome.tabs.update(tabs[0].id, { url: href });
    });
  }

  return false;
};
```

With `openInNewTab` set to true, the link will open in new window. WIth it false, the link will open in the same window. Try both, updating the Chrome Extension then testing the link in the popup.

No need to add activeTab and tab permissions. Those are for more particular reasons than just opening an url at a new tab or current tab:
- [[Permission activeTab - Chrome Extension]]
- [[Permission tabs - Chrome Extension]]

---
----



## Badge number




---
---


Popup Tabbars?
There's no tab bar component or anything from Chrome extension. It's all CSS and HTML.

![[Pasted image 20250318220914.png]]

---


Popup - Menu-like popover is still all CSS and HTML, but there is a Chrome theme api that helps a bit. Refer to [[Popup looking like a native Chrome menu]]
^ Untested